#include <stdio.h>
#include <stdlib.h>
#include <memory.h>
#include <stdbool.h>
#include "Cryptography\RC4.h"

int main()
{
	uint8_t data[] = {
		0x32, 0x31, 0x30, 0x39, 0x38, 0x37, 0x36, 0x35, 0x34, 0x33, 0x32, 0x31, 0x30, 0x39, 0x38, 0x37, 0x36, 0x35,
		0x34, 0x33, 0x32, 0x31, 0x30, 0x39, 0x38, 0x37, 0x36, 0x35, 0x34, 0x33, 0x32, 0x31, 0x30, 0x39, 0x38,
		0x37, 0x36, 0x35, 0x34, 0x33, 0x32, 0x31, 0x30, 0x39, 0x38, 0x37, 0x36, 0x35, 0x34, 0x33, 0x32, 0x31,
		0x30, 0x39, 0x38, 0x37, 0x36, 0x35, 0x34, 0x33, 0x32, 0x31, 0x30
	};
	uint8_t key[] = { 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a };
	
	uint8_t* encrypted = malloc(sizeof(data));
	memcpy(encrypted, data, sizeof(data));
	uint8_t* decrypted = malloc(sizeof(data));
	memcpy(decrypted, data, sizeof(data));

	RC4_Init(key, sizeof(key));
	RC4_Transform_Full_Direct(encrypted, 0, sizeof(data));
	RC4_Transform_Full_Direct(encrypted, 0, sizeof(data));
	RC4_Dispose();

	bool equal = true;

	for (int i = 0; i < sizeof(data); i++)
	{
		if (encrypted[i] != data[i])
		{
			equal = false;
			break;
		}
	}

	return 0;
}
